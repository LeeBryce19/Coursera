---
onetitle: R_markdown_001
author: "Shubham Vigoniya"
date: "2024-07-21"
output:
  html_document: default
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data Analysis Of NYPD Shooting Incident

[![NYPD](images/gianandrea-villa-m7cSgimQjfs-unsplash.jpg)](https://unsplash.com/photos/white-and-blue-nypd-suv-m7cSgimQjfs)

**Data Provider: Police Department**\
**Last Updated: April 23, 2024**

^**ImportÂ library**^

```{r}
library(dplyr)
library(tidyverse)
library(lubridate)
library(glue)
library(ggplot2)
```

This is the breakdown of every shooting incident that occurred in NYC from 2006 until 2023.

### **Import Data**

```{r NYPD dataset}
NYPD <- read.csv("https://data.cityofnewyork.us/resource/833y-fsy8.csv?$limit=28562")

```

#### NYPD: Maximum number of Shooting incidents

Changing the format of occur_date column in dataset using as.date() function and load date as factor. Total number of shooting incident in the NYPD historic data, transform the dataset to get top five dates when the shooting incidents are maximum.

```{r}
NYPD_1 <- subset(NYPD, select = -c(incident_key,occur_date)) 
incident_key<- NYPD$incident_key
occur_date <- as.Date(NYPD$occur_date)
occur_date<- factor(occur_date)
head(date)
NYPD_data <- data.frame(incident_key,occur_date, NYPD_1)
NYPD_by_date <- NYPD_data %>% group_by(occur_date) %>% 
  summarise(total_count=n(),
            .groups = 'drop')

NYPD_by_date<-NYPD_by_date%>%top_n(5)

NYPD_by_date
```

Select columns for analysis using select() function

```{r}
NYPD_data%>% select(incident_key,occur_date,occur_time,boro,loc_of_occur_desc,precinct,jurisdiction_code,loc_classfctn_desc,location_desc,statistical_murder_flag,perp_age_group,perp_sex,perp_race,vic_age_group,vic_sex,vic_race) %>% head(5)
```

```{r}
summary(NYPD_data)
```

## **Plot**

### plot.1 Data visualization

The plot shows total number of shooting incident take place with respect to each borough in New York City.

```{r}
ggplot(NYPD_data,mapping = aes(x = boro))+geom_bar(color = 'red', fill = '#1c4cbd',alpha = 0.8 )+labs(title = "NYPD Shooting Incident Based On Borough")+theme_bw()

NYPD_boro <- NYPD_data %>% group_by(boro) %>% 
  summarise(total_count=n(),
            .groups = 'drop')
NYPD_boro
```

### plot.2 Data visualization

This data visualization plot summaries the statistical murder in NYPD shooting Incident.

```{r}
ggplot(NYPD,mapping= aes(x= statistical_murder_flag ))+ geom_bar(color = "red", fill = "#4278f5", alpha = 0.8)+ labs(title = "NYPD Statistical Murder")+theme_bw()
NYPD_statistical_murder <- NYPD_data %>% group_by(statistical_murder_flag) %>% 
  summarise(total_count=n(),
            .groups = 'drop')
NYPD_statistical_murder


```

### plot.3 Data visualization

This data visualization plot summaries Victim race and Perpetrator race in NYPD shooting Incident.

```{r}
ggplot(NYPD_data,mapping= aes(y= vic_race ))+ geom_bar(color = "red", fill = "#4278f5", alpha = 0.8)+ labs(title = "COUNT OF INCIDENT BASED ON VICTIM'S RACE")+theme_bw()


NYPD_Victim_race <- NYPD_data %>% group_by(vic_race) %>% 
  summarise(total_count=n(),
            .groups = 'drop')

ggplot(NYPD_data,mapping= aes(y= perp_race ))+ geom_bar(color = "red", fill = "#4278f5", alpha = 0.8)+ labs(title = "COUNT OF INCIDENT BASED ON PREP'S RACE")+theme_bw()

NYPD_perpetrator_race <- NYPD_data %>% group_by(perp_race) %>% 
  summarise(total_count=n(),
            .groups = 'drop')
# changing column names
colnames(NYPD_Victim_race)[2]<- "VICTIM"
colnames(NYPD_perpetrator_race)[2]<- "PERPETRATOR"
NYPD_Victim_race
NYPD_perpetrator_race
```

### plot.4 Data visualization

```{r}
NYPD_dataset_1<- filter(NYPD, vic_race == "BLACK" & perp_race == "BLACK") %>% select(vic_race, perp_race)

NYPD_dataset_2<- filter(NYPD, vic_race == "WHITE HISPANIC" & perp_race == "WHITE HISPANIC") %>% select(vic_race, perp_race)

NYPD_dataset_3<- filter(NYPD, vic_race == "BLACK HISPANIC" & perp_race == "BLACK HISPANIC") %>% select(vic_race, perp_race)

NYPD_dataset_4<- filter(NYPD, vic_race == "ASIAN / PACIFIC ISLANDER" & perp_race == "ASIAN / PACIFIC ISLANDER") %>% select(vic_race, perp_race)

NYPD_dataset_5<- filter(NYPD, vic_race == "WHITE" & perp_race == "WHITE") %>% select(vic_race, perp_race)

NYPD_dataset_6<- filter(NYPD, vic_race == "AMERICAN INDIAN/ALASKAN NATIVE" & perp_race == "AMERICAN INDIAN/ALASKAN NATIVE") %>% select(vic_race, perp_race)


# same race BLACK == BLACK
RACE<- factor(c("BLACK","WHITE HISPANIC", "BLACK HISPANIC","ASIAN / PACIFIC ISLANDER","WHITE", "AMERICAN INDIAN/ALASKAN NATIVE"),levels =  c("BLACK","WHITE HISPANIC","BLACK HISPANIC","ASIAN / PACIFIC ISLANDER","WHITE","AMERICAN INDIAN/ALASKAN NATIVE"))

black_race <- nrow(NYPD_dataset_1)
white_hispanic_race <- nrow(NYPD_dataset_2)
black_hispanic<- nrow(NYPD_dataset_3)
asian_race <- nrow(NYPD_dataset_4)
white<- nrow(NYPD_dataset_5)
american_indian_race <- nrow(NYPD_dataset_6)

SAME_RACE <- c(black_race,white_hispanic_race,black_hispanic,asian_race,white,american_indian_race)

VIC_PERP_SAME_RACE<- data.frame(RACE, SAME_RACE)
VIC_PERP_SAME_RACE

ggplot(VIC_PERP_SAME_RACE, mapping = aes(x = RACE, y = SAME_RACE))+geom_point(aes(color= RACE))
```

### DATA ANALYSIS FINDING WITH CONCLUSION

+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -   NYPD: Maximum number of Shooting incidents                                                                                                                                                                                                                    |
|                                                                                                                                                                                                                                                                   |
| -   Highest shooting incident recorded                                                                                                                                                                                                                            |
|                                                                                                                                                                                                                                                                   |
|     -   Date: 07/05/2020                                                                                                                                                                                                                                          |
|                                                                                                                                                                                                                                                                   |
|     -   In total: 47                                                                                                                                                                                                                                              |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -   plot.1 Data visualization                                                                                                                                                                                                                                     |
| -   Among five borough in the city of New York, which has highest shooting incident recorded:                                                                                                                                                                     |
|     -   Highest: 11346                                                                                                                                                                                                                                            |
|     -   lowest: 807                                                                                                                                                                                                                                               |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -   plot.2 Data visualization                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                                                                                   |
| -   Statistical Murder in NYPD shooting incident                                                                                                                                                                                                                  |
|                                                                                                                                                                                                                                                                   |
|     -   "false" value in statistical murder variable in the dataset indicates to "no murder during shooting incident" and "true" indicates to "murdered during shooting incident".                                                                                |
|                                                                                                                                                                                                                                                                   |
|         -   "false": 23026                                                                                                                                                                                                                                        |
|                                                                                                                                                                                                                                                                   |
|         -   "true": 5526                                                                                                                                                                                                                                          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -   plot.3 Data visualization                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                                                                                   |
| -   Among the race of victim and perpetrator which race has highest and lowest shooting incident:                                                                                                                                                                 |
|                                                                                                                                                                                                                                                                   |
|     -   Victim Race                                                                                                                                                                                                                                               |
|                                                                                                                                                                                                                                                                   |
|         -   Highest                                                                                                                                                                                                                                               |
|                                                                                                                                                                                                                                                                   |
|             -   Race: BLACK                                                                                                                                                                                                                                       |
|                                                                                                                                                                                                                                                                   |
|             -   incident: 20235                                                                                                                                                                                                                                   |
|                                                                                                                                                                                                                                                                   |
|         -   lowest:                                                                                                                                                                                                                                               |
|                                                                                                                                                                                                                                                                   |
|             -   Race: AMERICAN INDIAN/ALASKAN NATIVE                                                                                                                                                                                                              |
|                                                                                                                                                                                                                                                                   |
|             -   incident: 11                                                                                                                                                                                                                                      |
|                                                                                                                                                                                                                                                                   |
|     -   Perpetrator Race                                                                                                                                                                                                                                          |
|                                                                                                                                                                                                                                                                   |
|         -   Highest                                                                                                                                                                                                                                               |
|                                                                                                                                                                                                                                                                   |
|             -   Race: BLACK                                                                                                                                                                                                                                       |
|                                                                                                                                                                                                                                                                   |
|             -   incident: 11903                                                                                                                                                                                                                                   |
|                                                                                                                                                                                                                                                                   |
|         -   lowest:                                                                                                                                                                                                                                               |
|                                                                                                                                                                                                                                                                   |
|             -   Race: AMERICAN INDIAN/ALASKAN NATIVE                                                                                                                                                                                                              |
|                                                                                                                                                                                                                                                                   |
|             -   incident: 2                                                                                                                                                                                                                                       |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -   plot.4 Data visualization                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                                                                                   |
| -   On the basis of victim and perpetrator, there are 9411 record have found where victim and perpetrators are same race as "BLACK", In other word "BLACK" has major shooting incident as compared to other race (where victim and perpetrator are of same race). |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                                                                                   |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

: Results
